<div class="entry-content">
<p>Bankruptcy is a state of insolvency when a business or legal person cannot repay debts to creditors. Bankruptcy is primarily imposed by court order when initiated by the debtor. In this article, I will walk you through how to train a bankruptcy prediction model with machine learning using Python.</p><div class="code-block code-block-2" style="margin: 8px auto; text-align: center; display: block; clear: both;">
<script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6306647371633064"></script>
<!-- Aman -->
<ins class="adsbygoogle" data-ad-client="ca-pub-6306647371633064" data-ad-format="auto" data-ad-slot="6671908539" data-full-width-responsive="true" style="display:block"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
<h2 class="wp-block-heading">Bankruptcy Prediction Model with Machine Learning</h2>
<p>Bankruptcy is the concept of financial accounts. If you are one of the data science enthusiasts who started with data science after commerce then you should be aware of what bankruptcy is. When a business or legal person fails to pay the debts of creditors and becomes insolvent at some point, this type of situation is called bankruptcy.</p>
<p>By using machine learning algorithms we can train a model to predict whether a company or a legal person will become bankrupt in future or not. In the section below, I will take you through a machine learning tutorial on how to train a model for the task of bankruptcy prediction of a company by using the Python programming language.</p>
<h2 class="wp-block-heading">Bankruptcy Prediction Model using Python</h2>
<p>The dataset that I will be using for this task is collected from Kaggle and it is provided by the Taiwan Economic Journal. Now let’s import the dataset and the necessary Python libraries to start with the task of training a bankruptcy prediction model using Python:</p>
<div class="wp-block-buttons is-layout-flex">
<div class="wp-block-button is-style-circular"><a class="wp-block-button__link" href="https://github.com/amankharwal/Website-data/blob/master/bank.csv?raw=true"><strong><em>Dataset</em></strong></a></div>
</div>
<div class="wp-block-codemirror-blocks-code-block code-block"><pre class="CodeMirror" data-setting='{"mode":"python","mime":"text/x-python","theme":"neo","lineNumbers":true,"styleActiveLine":false,"lineWrapping":false,"readOnly":true,"showPanel":false,"language":"Python","modeName":"python"}'>import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score

data = pd.read_csv("bank.csv")
data.head()</pre></div>
<div class="wp-block-image"><figure class="aligncenter size-large"><img alt="bankruptcy dataset" class="wp-image-12919 jetpack-lazy-image" data-attachment-id="12919" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="bank" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/bank.png?fit=1024%2C272&amp;ssl=1" data-lazy-sizes="(max-width: 1024px) 100vw, 1024px" data-lazy-src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/bank.png?resize=1024%2C272&amp;is-pending-load=1#038;ssl=1" data-lazy-srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/bank.png?resize=1024%2C272&amp;ssl=1 1024w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/bank.png?resize=300%2C80&amp;ssl=1 300w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/bank.png?resize=768%2C204&amp;ssl=1 768w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/bank.png?resize=1536%2C408&amp;ssl=1 1536w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/bank.png?resize=1200%2C318&amp;ssl=1 1200w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/bank.png?w=1764&amp;ssl=1 1764w" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/bank.png?fit=300%2C80&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/bank.png?fit=1764%2C468&amp;ssl=1" data-orig-size="1764,468" data-permalink="https://thecleverprogrammer.com/2021/03/13/bankruptcy-prediction-model-with-machine-learning/bank/" data-recalc-dims="1" decoding="async" height="272" src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/bank.png?resize=1024%2C272&amp;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" width="1024"/><noscript><img alt="bankruptcy dataset" class="wp-image-12919" data-attachment-id="12919" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="bank" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/bank.png?fit=1024%2C272&amp;ssl=1" data-lazy-fallback="1" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/bank.png?fit=300%2C80&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/bank.png?fit=1764%2C468&amp;ssl=1" data-orig-size="1764,468" data-permalink="https://thecleverprogrammer.com/2021/03/13/bankruptcy-prediction-model-with-machine-learning/bank/" data-recalc-dims="1" decoding="async" height="272" sizes="(max-width: 1024px) 100vw, 1024px" src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/bank.png?resize=1024%2C272&amp;ssl=1" srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/bank.png?resize=1024%2C272&amp;ssl=1 1024w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/bank.png?resize=300%2C80&amp;ssl=1 300w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/bank.png?resize=768%2C204&amp;ssl=1 768w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/bank.png?resize=1536%2C408&amp;ssl=1 1536w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/bank.png?resize=1200%2C318&amp;ssl=1 1200w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/bank.png?w=1764&amp;ssl=1 1764w" width="1024"/></noscript></figure></div>
<p>The dataset contains 96 columns, let’s have a look at the correlation before training the model:</p><div class="code-block code-block-2" style="margin: 8px auto; text-align: center; display: block; clear: both;">
<script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6306647371633064"></script>
<!-- Aman -->
<ins class="adsbygoogle" data-ad-client="ca-pub-6306647371633064" data-ad-format="auto" data-ad-slot="6671908539" data-full-width-responsive="true" style="display:block"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
<div class="wp-block-codemirror-blocks-code-block code-block"><pre class="CodeMirror" data-setting='{"mode":"python","mime":"text/x-python","theme":"neo","lineNumbers":true,"styleActiveLine":false,"lineWrapping":false,"readOnly":true,"showPanel":false,"language":"Python","modeName":"python"}'>import matplotlib.pyplot as plt
import seaborn as sns
sns.set()
sns.heatmap(data.corr())
plt.show()</pre></div>
<div class="wp-block-image"><figure class="aligncenter size-large"><img alt="correlation in the dataset" class="wp-image-12921 jetpack-lazy-image" data-attachment-id="12921" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="image-1" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/image-1.png?fit=593%2C443&amp;ssl=1" data-lazy-sizes="(max-width: 593px) 100vw, 593px" data-lazy-src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/image-1.png?resize=593%2C443&amp;is-pending-load=1#038;ssl=1" data-lazy-srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/image-1.png?w=593&amp;ssl=1 593w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/image-1.png?resize=300%2C224&amp;ssl=1 300w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/image-1.png?resize=400%2C300&amp;ssl=1 400w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/image-1.png?resize=200%2C150&amp;ssl=1 200w" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/image-1.png?fit=300%2C224&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/image-1.png?fit=593%2C443&amp;ssl=1" data-orig-size="593,443" data-permalink="https://thecleverprogrammer.com/2021/03/13/bankruptcy-prediction-model-with-machine-learning/image-1-13/" data-recalc-dims="1" decoding="async" height="443" src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/image-1.png?resize=593%2C443&amp;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" width="593"/><noscript><img alt="correlation in the dataset" class="wp-image-12921" data-attachment-id="12921" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="image-1" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/image-1.png?fit=593%2C443&amp;ssl=1" data-lazy-fallback="1" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/image-1.png?fit=300%2C224&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/image-1.png?fit=593%2C443&amp;ssl=1" data-orig-size="593,443" data-permalink="https://thecleverprogrammer.com/2021/03/13/bankruptcy-prediction-model-with-machine-learning/image-1-13/" data-recalc-dims="1" decoding="async" height="443" loading="lazy" sizes="(max-width: 593px) 100vw, 593px" src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/image-1.png?resize=593%2C443&amp;ssl=1" srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/image-1.png?w=593&amp;ssl=1 593w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/image-1.png?resize=300%2C224&amp;ssl=1 300w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/image-1.png?resize=400%2C300&amp;ssl=1 400w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2021/03/image-1.png?resize=200%2C150&amp;ssl=1 200w" width="593"/></noscript></figure></div>
<p>As the “Bankrupt?” column is the target label so I will drop it from the training data:</p>
<div class="wp-block-codemirror-blocks-code-block code-block"><pre class="CodeMirror" data-setting='{"mode":"python","mime":"text/x-python","theme":"neo","lineNumbers":true,"styleActiveLine":false,"lineWrapping":false,"readOnly":true,"showPanel":false,"language":"Python","modeName":"python"}'>X = data.drop(["Bankrupt?"], axis="columns")
y = data["Bankrupt?"]</pre></div>
<p>Now let’s split the dataset and use the <strong><em><a href="https://thecleverprogrammer.com/2020/11/25/logistic-regression-with-python/">logistic regression</a></em></strong> model to train the bankruptcy prediction model:</p>
<div class="wp-block-codemirror-blocks-code-block code-block"><pre class="CodeMirror" data-setting='{"mode":"python","mime":"text/x-python","theme":"neo","lineNumbers":true,"styleActiveLine":false,"lineWrapping":false,"readOnly":true,"showPanel":false,"language":"Python","modeName":"python"}'>x_train, x_test, y_train, y_test = train_test_split(X, y, test_size=0.2)
logreg = LogisticRegression()
logreg.fit(x_train, y_train)</pre></div>
<pre class="wp-block-preformatted">LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True,
                   intercept_scaling=1, l1_ratio=None, max_iter=100,
                   multi_class='auto', n_jobs=None, penalty='l2',
                   random_state=None, solver='lbfgs', tol=0.0001, verbose=0,
                   warm_start=False)</pre>
<p>Now let’s have a look at the accuracy score on the training set:</p>
<div class="wp-block-codemirror-blocks-code-block code-block"><pre class="CodeMirror" data-setting='{"mode":"python","mime":"text/x-python","theme":"neo","lineNumbers":true,"styleActiveLine":false,"lineWrapping":false,"readOnly":true,"showPanel":false,"language":"Python","modeName":"python"}'>logreg.score(x_test, y_test)</pre></div>
<pre class="wp-block-preformatted"><strong>0.9596774193548387
</strong></pre>
<h3 class="wp-block-heading">Conclusion</h3>
<p>So the model is performing well on the training data by giving an accuracy of about 95%. This is how we can use machine learning in finance. You can do a lot more on this dataset to explore more use cases of machine learning in finance. I hope you liked this article on how to train a bankruptcy prediction model with machine learning using Python. Feel free to ask your valuable questions in the comments section below.</p><div class="code-block code-block-2" style="margin: 8px auto; text-align: center; display: block; clear: both;">
<script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6306647371633064"></script>
<!-- Aman -->
<ins class="adsbygoogle" data-ad-client="ca-pub-6306647371633064" data-ad-format="auto" data-ad-slot="6671908539" data-full-width-responsive="true" style="display:block"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
<!-- AI CONTENT END 1 -->
</div>