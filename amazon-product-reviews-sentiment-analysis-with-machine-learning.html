<div class="entry-content">
<div class="wp-block-image"><figure class="aligncenter size-large"><img alt="" class="wp-image-2715 jetpack-lazy-image" data-attachment-id="2715" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="Untitled-62" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/06/Untitled-62.png?fit=1024%2C576&amp;ssl=1" data-lazy-sizes="(max-width: 1280px) 100vw, 1280px" data-lazy-src="https://i2.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/06/Untitled-62.png?fit=580%2C326&amp;ssl=1&amp;is-pending-load=1" data-lazy-srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/06/Untitled-62.png?w=1280&amp;ssl=1 1280w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/06/Untitled-62.png?resize=300%2C169&amp;ssl=1 300w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/06/Untitled-62.png?resize=1024%2C576&amp;ssl=1 1024w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/06/Untitled-62.png?resize=768%2C432&amp;ssl=1 768w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/06/Untitled-62.png?resize=1200%2C675&amp;ssl=1 1200w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/06/Untitled-62.png?resize=600%2C338&amp;ssl=1 600w" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/06/Untitled-62.png?fit=300%2C169&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/06/Untitled-62.png?fit=1280%2C720&amp;ssl=1" data-orig-size="1280,720" data-permalink="https://thecleverprogrammer.com/2020/05/15/amazon-product-reviews-sentiment-analysis-with-machine-learning/untitled-62-2/" decoding="async" height="720" src="https://i2.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/06/Untitled-62.png?fit=580%2C326&amp;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" width="1280"/><noscript><img alt="" class="wp-image-2715" data-attachment-id="2715" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="Untitled-62" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/06/Untitled-62.png?fit=1024%2C576&amp;ssl=1" data-lazy-fallback="1" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/06/Untitled-62.png?fit=300%2C169&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/06/Untitled-62.png?fit=1280%2C720&amp;ssl=1" data-orig-size="1280,720" data-permalink="https://thecleverprogrammer.com/2020/05/15/amazon-product-reviews-sentiment-analysis-with-machine-learning/untitled-62-2/" decoding="async" height="720" sizes="(max-width: 1280px) 100vw, 1280px" src="https://i2.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/06/Untitled-62.png?fit=580%2C326&amp;ssl=1" srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/06/Untitled-62.png?w=1280&amp;ssl=1 1280w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/06/Untitled-62.png?resize=300%2C169&amp;ssl=1 300w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/06/Untitled-62.png?resize=1024%2C576&amp;ssl=1 1024w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/06/Untitled-62.png?resize=768%2C432&amp;ssl=1 768w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/06/Untitled-62.png?resize=1200%2C675&amp;ssl=1 1200w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/06/Untitled-62.png?resize=600%2C338&amp;ssl=1 600w" width="1280"/></noscript></figure></div>
<p><strong>Product reviews are becoming more important with the evolution of traditional brick and mortar retail stores to online shopping. </strong></p><div class="code-block code-block-2" style="margin: 8px auto; text-align: center; display: block; clear: both;">
<script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6306647371633064"></script>
<!-- Aman -->
<ins class="adsbygoogle" data-ad-client="ca-pub-6306647371633064" data-ad-format="auto" data-ad-slot="6671908539" data-full-width-responsive="true" style="display:block"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
<p><strong>Consumers are posting reviews directly on product pages in real time. With the vast amount of consumer reviews, this creates an opportunity to see how the market reacts to a specific product. </strong></p>
<p><strong>We will be attempting to see if we can predict the sentiment of a product review using python and machine learning.</strong></p>
<h3 class="wp-block-heading">Let’s Import the necessary Modules and take a look at the data:</h3>
<p>You can download this dataset from <a href="https://github.com/amankharwal/Amazon-Sentiment-Analysis/blob/master/amazon.rar">here</a>.</p>
<div class="wp-block-codemirror-blocks-code-block code-block"><pre class="CodeMirror" data-setting='{"mode":"python","mime":"text/x-python","theme":"default","lineNumbers":true,"styleActiveLine":false,"lineWrapping":false,"readOnly":true,"showPanel":false,"language":"Python","modeName":"python"}'>import matplotlib.pyplot as plt
import pandas as pd
import numpy as np
import seaborn as sns
import math
import warnings
warnings.filterwarnings('ignore') # Hides warning
warnings.filterwarnings("ignore", category=DeprecationWarning)
warnings.filterwarnings("ignore",category=UserWarning)
sns.set_style("whitegrid") # Plotting style
np.random.seed(7) # seeding random number generator

df = pd.read_csv('amazon.csv')
print(df.head())</pre></div>
<figure class="wp-block-image size-large is-resized"><img alt="" class="wp-image-1422 jetpack-lazy-image" data-attachment-id="1422" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="Untitled-37" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-37.png?fit=532%2C225&amp;ssl=1" data-lazy-sizes="(max-width: 437px) 100vw, 437px" data-lazy-src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-37.png?resize=437%2C185&amp;is-pending-load=1#038;ssl=1" data-lazy-srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-37.png?w=532&amp;ssl=1 532w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-37.png?resize=300%2C127&amp;ssl=1 300w" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-37.png?fit=300%2C127&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-37.png?fit=532%2C225&amp;ssl=1" data-orig-size="532,225" data-permalink="https://thecleverprogrammer.com/2020/05/15/amazon-product-reviews-sentiment-analysis-with-machine-learning/untitled-37-2/" data-recalc-dims="1" decoding="async" height="185" src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-37.png?resize=437%2C185&amp;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" width="437"/><noscript><img alt="" class="wp-image-1422" data-attachment-id="1422" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="Untitled-37" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-37.png?fit=532%2C225&amp;ssl=1" data-lazy-fallback="1" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-37.png?fit=300%2C127&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-37.png?fit=532%2C225&amp;ssl=1" data-orig-size="532,225" data-permalink="https://thecleverprogrammer.com/2020/05/15/amazon-product-reviews-sentiment-analysis-with-machine-learning/untitled-37-2/" data-recalc-dims="1" decoding="async" height="185" loading="lazy" sizes="(max-width: 437px) 100vw, 437px" src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-37.png?resize=437%2C185&amp;ssl=1" srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-37.png?w=532&amp;ssl=1 532w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-37.png?resize=300%2C127&amp;ssl=1 300w" width="437"/></noscript></figure>
<h2 class="wp-block-heading"><strong>Describing the Dataset</strong></h2>
<div class="wp-block-codemirror-blocks-code-block code-block"><pre class="CodeMirror" data-setting='{"mode":"python","mime":"text/x-python","theme":"default","lineNumbers":true,"styleActiveLine":false,"lineWrapping":false,"readOnly":true,"showPanel":false,"language":"Python","modeName":"python"}'>data = df.copy()
data.describe()</pre></div>
<figure class="wp-block-image size-large"><img alt="" class="wp-image-1423 jetpack-lazy-image" data-attachment-id="1423" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="Untitled-38" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-38.png?fit=1024%2C386&amp;ssl=1" data-lazy-sizes="(max-width: 1124px) 100vw, 1124px" data-lazy-src="https://i2.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-38.png?fit=580%2C219&amp;ssl=1&amp;is-pending-load=1" data-lazy-srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-38.png?w=1124&amp;ssl=1 1124w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-38.png?resize=300%2C113&amp;ssl=1 300w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-38.png?resize=1024%2C386&amp;ssl=1 1024w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-38.png?resize=768%2C290&amp;ssl=1 768w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-38.png?resize=600%2C226&amp;ssl=1 600w" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-38.png?fit=300%2C113&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-38.png?fit=1124%2C424&amp;ssl=1" data-orig-size="1124,424" data-permalink="https://thecleverprogrammer.com/2020/05/15/amazon-product-reviews-sentiment-analysis-with-machine-learning/untitled-38-2/" decoding="async" height="424" src="https://i2.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-38.png?fit=580%2C219&amp;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" width="1124"/><noscript><img alt="" class="wp-image-1423" data-attachment-id="1423" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="Untitled-38" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-38.png?fit=1024%2C386&amp;ssl=1" data-lazy-fallback="1" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-38.png?fit=300%2C113&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-38.png?fit=1124%2C424&amp;ssl=1" data-orig-size="1124,424" data-permalink="https://thecleverprogrammer.com/2020/05/15/amazon-product-reviews-sentiment-analysis-with-machine-learning/untitled-38-2/" decoding="async" height="424" loading="lazy" sizes="(max-width: 1124px) 100vw, 1124px" src="https://i2.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-38.png?fit=580%2C219&amp;ssl=1" srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-38.png?w=1124&amp;ssl=1 1124w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-38.png?resize=300%2C113&amp;ssl=1 300w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-38.png?resize=1024%2C386&amp;ssl=1 1024w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-38.png?resize=768%2C290&amp;ssl=1 768w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-38.png?resize=600%2C226&amp;ssl=1 600w" width="1124"/></noscript></figure>
<div class="wp-block-codemirror-blocks-code-block code-block"><pre class="CodeMirror" data-setting='{"mode":"python","mime":"text/x-python","theme":"default","lineNumbers":true,"styleActiveLine":false,"lineWrapping":false,"readOnly":true,"showPanel":false,"language":"Python","modeName":"python"}'>data.info()</pre></div>
<figure class="wp-block-image size-large is-resized"><img alt="" class="wp-image-1425 jetpack-lazy-image" data-attachment-id="1425" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="Untitled-39" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-39.png?fit=643%2C739&amp;ssl=1" data-lazy-sizes="(max-width: 460px) 100vw, 460px" data-lazy-src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-39.png?resize=460%2C528&amp;is-pending-load=1#038;ssl=1" data-lazy-srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-39.png?w=643&amp;ssl=1 643w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-39.png?resize=261%2C300&amp;ssl=1 261w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-39.png?resize=600%2C690&amp;ssl=1 600w" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-39.png?fit=261%2C300&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-39.png?fit=643%2C739&amp;ssl=1" data-orig-size="643,739" data-permalink="https://thecleverprogrammer.com/2020/05/15/amazon-product-reviews-sentiment-analysis-with-machine-learning/untitled-39-2/" data-recalc-dims="1" decoding="async" height="528" src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-39.png?resize=460%2C528&amp;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" width="460"/><noscript><img alt="" class="wp-image-1425" data-attachment-id="1425" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="Untitled-39" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-39.png?fit=643%2C739&amp;ssl=1" data-lazy-fallback="1" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-39.png?fit=261%2C300&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-39.png?fit=643%2C739&amp;ssl=1" data-orig-size="643,739" data-permalink="https://thecleverprogrammer.com/2020/05/15/amazon-product-reviews-sentiment-analysis-with-machine-learning/untitled-39-2/" data-recalc-dims="1" decoding="async" height="528" loading="lazy" sizes="(max-width: 460px) 100vw, 460px" src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-39.png?resize=460%2C528&amp;ssl=1" srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-39.png?w=643&amp;ssl=1 643w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-39.png?resize=261%2C300&amp;ssl=1 261w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-39.png?resize=600%2C690&amp;ssl=1 600w" width="460"/></noscript></figure>
<p><strong>We need to clean up the name column by referencing asins (unique products) since we have 7000 missing values</strong>:</p><div class="code-block code-block-2" style="margin: 8px auto; text-align: center; display: block; clear: both;">
<script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6306647371633064"></script>
<!-- Aman -->
<ins class="adsbygoogle" data-ad-client="ca-pub-6306647371633064" data-ad-format="auto" data-ad-slot="6671908539" data-full-width-responsive="true" style="display:block"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
<div class="wp-block-codemirror-blocks-code-block code-block"><pre class="CodeMirror" data-setting='{"mode":"python","mime":"text/x-python","theme":"default","lineNumbers":true,"styleActiveLine":false,"lineWrapping":false,"readOnly":true,"showPanel":false,"language":"Python","modeName":"python"}'>data["asins"].unique()</pre></div>
<figure class="wp-block-image size-large"><img alt="" class="wp-image-1426 jetpack-lazy-image" data-attachment-id="1426" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="Untitled-40" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-40.png?fit=860%2C306&amp;ssl=1" data-lazy-sizes="(max-width: 860px) 100vw, 860px" data-lazy-src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-40.png?resize=860%2C306&amp;is-pending-load=1#038;ssl=1" data-lazy-srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-40.png?w=860&amp;ssl=1 860w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-40.png?resize=300%2C107&amp;ssl=1 300w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-40.png?resize=768%2C273&amp;ssl=1 768w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-40.png?resize=600%2C213&amp;ssl=1 600w" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-40.png?fit=300%2C107&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-40.png?fit=860%2C306&amp;ssl=1" data-orig-size="860,306" data-permalink="https://thecleverprogrammer.com/2020/05/15/amazon-product-reviews-sentiment-analysis-with-machine-learning/untitled-40-2/" data-recalc-dims="1" decoding="async" height="306" src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-40.png?resize=860%2C306&amp;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" width="860"/><noscript><img alt="" class="wp-image-1426" data-attachment-id="1426" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="Untitled-40" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-40.png?fit=860%2C306&amp;ssl=1" data-lazy-fallback="1" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-40.png?fit=300%2C107&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-40.png?fit=860%2C306&amp;ssl=1" data-orig-size="860,306" data-permalink="https://thecleverprogrammer.com/2020/05/15/amazon-product-reviews-sentiment-analysis-with-machine-learning/untitled-40-2/" data-recalc-dims="1" decoding="async" height="306" loading="lazy" sizes="(max-width: 860px) 100vw, 860px" src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-40.png?resize=860%2C306&amp;ssl=1" srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-40.png?w=860&amp;ssl=1 860w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-40.png?resize=300%2C107&amp;ssl=1 300w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-40.png?resize=768%2C273&amp;ssl=1 768w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-40.png?resize=600%2C213&amp;ssl=1 600w" width="860"/></noscript></figure>
<div class="wp-block-codemirror-blocks-code-block code-block"><pre class="CodeMirror" data-setting='{"mode":"python","mime":"text/x-python","theme":"default","lineNumbers":true,"styleActiveLine":false,"lineWrapping":false,"readOnly":true,"showPanel":false,"language":"Python","modeName":"python"}'>asins_unique = len(data["asins"].unique())
print("Number of Unique ASINs: " + str(asins_unique))</pre></div>
<p><strong>#Output</strong>– Number of Unique ASINs: 42</p>
<h3 class="wp-block-heading"><strong>Visualizing the distributions of numerical variables:</strong></h3>
<div class="wp-block-codemirror-blocks-code-block code-block"><pre class="CodeMirror" data-setting='{"mode":"python","mime":"text/x-python","theme":"default","lineNumbers":true,"styleActiveLine":false,"lineWrapping":false,"readOnly":true,"showPanel":false,"language":"Python","modeName":"python"}'>data.hist(bins=50, figsize=(20,15))
plt.show()</pre></div>
<figure class="wp-block-image size-large"><img alt="" class="wp-image-1429 jetpack-lazy-image" data-attachment-id="1429" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="download" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download.png?fit=1024%2C756&amp;ssl=1" data-lazy-sizes="(max-width: 1168px) 100vw, 1168px" data-lazy-src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download.png?fit=580%2C428&amp;ssl=1&amp;is-pending-load=1" data-lazy-srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download.png?w=1168&amp;ssl=1 1168w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download.png?resize=300%2C221&amp;ssl=1 300w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download.png?resize=1024%2C756&amp;ssl=1 1024w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download.png?resize=768%2C567&amp;ssl=1 768w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download.png?resize=600%2C443&amp;ssl=1 600w" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download.png?fit=300%2C221&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download.png?fit=1168%2C862&amp;ssl=1" data-orig-size="1168,862" data-permalink="https://thecleverprogrammer.com/2020/05/15/amazon-product-reviews-sentiment-analysis-with-machine-learning/download/" decoding="async" height="862" src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download.png?fit=580%2C428&amp;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" width="1168"/><noscript><img alt="" class="wp-image-1429" data-attachment-id="1429" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="download" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download.png?fit=1024%2C756&amp;ssl=1" data-lazy-fallback="1" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download.png?fit=300%2C221&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download.png?fit=1168%2C862&amp;ssl=1" data-orig-size="1168,862" data-permalink="https://thecleverprogrammer.com/2020/05/15/amazon-product-reviews-sentiment-analysis-with-machine-learning/download/" decoding="async" height="862" loading="lazy" sizes="(max-width: 1168px) 100vw, 1168px" src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download.png?fit=580%2C428&amp;ssl=1" srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download.png?w=1168&amp;ssl=1 1168w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download.png?resize=300%2C221&amp;ssl=1 300w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download.png?resize=1024%2C756&amp;ssl=1 1024w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download.png?resize=768%2C567&amp;ssl=1 768w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download.png?resize=600%2C443&amp;ssl=1 600w" width="1168"/></noscript></figure>
<p><strong>Outliers in this case are valuable, so we may want to weight reviews that had more than 50+ people who find them helpful.</strong></p>
<p><strong>Majority of examples were rated highly (looking at rating distribution). There is twice amount of 5 star ratings than the others ratings combined</strong>.</p>
<h3 class="wp-block-heading">Split the data into Train and Test</h3>
<p><strong>Before we explore the dataset we will split it into training set and test sets. Eventually our goal is to train a sentiment analysis classifier.</strong></p><div class="code-block code-block-2" style="margin: 8px auto; text-align: center; display: block; clear: both;">
<script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6306647371633064"></script>
<!-- Aman -->
<ins class="adsbygoogle" data-ad-client="ca-pub-6306647371633064" data-ad-format="auto" data-ad-slot="6671908539" data-full-width-responsive="true" style="display:block"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
<p><strong>Since the majority of reviews are positive (5 stars), we will need to do a stratified split on the reviews score to ensure that we don’t train the classifier on imbalanced data</strong>.</p>
<div class="wp-block-codemirror-blocks-code-block code-block"><pre class="CodeMirror" data-setting='{"mode":"python","mime":"text/x-python","theme":"default","lineNumbers":true,"styleActiveLine":false,"lineWrapping":false,"readOnly":true,"showPanel":false,"language":"Python","modeName":"python"}'>from sklearn.model_selection import StratifiedShuffleSplit
print("Before {}".format(len(data)))
dataAfter = data.dropna(subset=["reviews.rating"])
# Removes all NAN in reviews.rating
print("After {}".format(len(dataAfter)))
dataAfter["reviews.rating"] = dataAfter["reviews.rating"].astype(int)

split = StratifiedShuffleSplit(n_splits=5, test_size=0.2)
for train_index, test_index in split.split(dataAfter,
                                           dataAfter["reviews.rating"]):
    strat_train = dataAfter.reindex(train_index)
    strat_test = dataAfter.reindex(test_index)</pre></div>
<p><strong>#Output-</strong></p>
<p>Before 34660 <br/>After 34627</p>
<p><strong>We need to see if train and test sets were stratified proportionately in comparison to raw data</strong>:</p><div class="code-block code-block-2" style="margin: 8px auto; text-align: center; display: block; clear: both;">
<script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6306647371633064"></script>
<!-- Aman -->
<ins class="adsbygoogle" data-ad-client="ca-pub-6306647371633064" data-ad-format="auto" data-ad-slot="6671908539" data-full-width-responsive="true" style="display:block"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
<div class="wp-block-codemirror-blocks-code-block code-block"><pre class="CodeMirror" data-setting='{"mode":"python","mime":"text/x-python","theme":"default","lineNumbers":true,"styleActiveLine":false,"lineWrapping":false,"readOnly":true,"showPanel":false,"language":"Python","modeName":"python"}'>print(len(strat_train))
print(len(strat_test))
print(strat_test["reviews.rating"].value_counts()/len(strat_test))</pre></div>
<figure class="wp-block-image size-large is-resized"><img alt="" class="wp-image-1430 jetpack-lazy-image" data-attachment-id="1430" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="Untitled-41" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-41.png?fit=454%2C224&amp;ssl=1" data-lazy-sizes="(max-width: 387px) 100vw, 387px" data-lazy-src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-41.png?resize=387%2C191&amp;is-pending-load=1#038;ssl=1" data-lazy-srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-41.png?w=454&amp;ssl=1 454w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-41.png?resize=300%2C148&amp;ssl=1 300w" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-41.png?fit=300%2C148&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-41.png?fit=454%2C224&amp;ssl=1" data-orig-size="454,224" data-permalink="https://thecleverprogrammer.com/2020/05/15/amazon-product-reviews-sentiment-analysis-with-machine-learning/untitled-41-2/" data-recalc-dims="1" decoding="async" height="191" src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-41.png?resize=387%2C191&amp;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" width="387"/><noscript><img alt="" class="wp-image-1430" data-attachment-id="1430" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="Untitled-41" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-41.png?fit=454%2C224&amp;ssl=1" data-lazy-fallback="1" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-41.png?fit=300%2C148&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-41.png?fit=454%2C224&amp;ssl=1" data-orig-size="454,224" data-permalink="https://thecleverprogrammer.com/2020/05/15/amazon-product-reviews-sentiment-analysis-with-machine-learning/untitled-41-2/" data-recalc-dims="1" decoding="async" height="191" loading="lazy" sizes="(max-width: 387px) 100vw, 387px" src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-41.png?resize=387%2C191&amp;ssl=1" srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-41.png?w=454&amp;ssl=1 454w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-41.png?resize=300%2C148&amp;ssl=1 300w" width="387"/></noscript></figure>
<h3 class="wp-block-heading">Data Exploration (Training Set)</h3>
<p><strong>We will use regular expressions to clean out any unfavorable characters in the dataset, and then preview what the data looks like after cleaning</strong>.</p>
<div class="wp-block-codemirror-blocks-code-block code-block"><pre class="CodeMirror" data-setting='{"mode":"python","mime":"text/x-python","theme":"default","lineNumbers":true,"styleActiveLine":false,"lineWrapping":false,"readOnly":true,"showPanel":false,"language":"Python","modeName":"python"}'>reviews = strat_train.copy()
reviews.head()</pre></div>
<figure class="wp-block-image size-large is-resized"><img alt="" class="wp-image-1435 jetpack-lazy-image" data-attachment-id="1435" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="Untitled-42" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-42.png?fit=539%2C217&amp;ssl=1" data-lazy-sizes="(max-width: 421px) 100vw, 421px" data-lazy-src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-42.png?resize=421%2C169&amp;is-pending-load=1#038;ssl=1" data-lazy-srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-42.png?w=539&amp;ssl=1 539w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-42.png?resize=300%2C121&amp;ssl=1 300w" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-42.png?fit=300%2C121&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-42.png?fit=539%2C217&amp;ssl=1" data-orig-size="539,217" data-permalink="https://thecleverprogrammer.com/2020/05/15/amazon-product-reviews-sentiment-analysis-with-machine-learning/untitled-42-2/" data-recalc-dims="1" decoding="async" height="169" src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-42.png?resize=421%2C169&amp;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" width="421"/><noscript><img alt="" class="wp-image-1435" data-attachment-id="1435" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="Untitled-42" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-42.png?fit=539%2C217&amp;ssl=1" data-lazy-fallback="1" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-42.png?fit=300%2C121&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-42.png?fit=539%2C217&amp;ssl=1" data-orig-size="539,217" data-permalink="https://thecleverprogrammer.com/2020/05/15/amazon-product-reviews-sentiment-analysis-with-machine-learning/untitled-42-2/" data-recalc-dims="1" decoding="async" height="169" loading="lazy" sizes="(max-width: 421px) 100vw, 421px" src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-42.png?resize=421%2C169&amp;ssl=1" srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-42.png?w=539&amp;ssl=1 539w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-42.png?resize=300%2C121&amp;ssl=1 300w" width="421"/></noscript></figure>
<div class="wp-block-codemirror-blocks-code-block code-block"><pre class="CodeMirror" data-setting='{"mode":"python","mime":"text/x-python","theme":"default","lineNumbers":true,"styleActiveLine":false,"lineWrapping":false,"readOnly":true,"showPanel":false,"language":"Python","modeName":"python"}'>print(len(reviews["name"].unique()), len(reviews["asins"].unique()))
print(reviews.info())
print(reviews.groupby("asins")["name"].unique())</pre></div>
<figure class="wp-block-image size-large is-resized"><img alt="" class="wp-image-1438 jetpack-lazy-image" data-attachment-id="1438" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="Untitled-43" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-43.png?fit=634%2C648&amp;ssl=1" data-lazy-sizes="(max-width: 516px) 100vw, 516px" data-lazy-src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-43.png?resize=516%2C527&amp;is-pending-load=1#038;ssl=1" data-lazy-srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-43.png?w=634&amp;ssl=1 634w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-43.png?resize=294%2C300&amp;ssl=1 294w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-43.png?resize=600%2C613&amp;ssl=1 600w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-43.png?resize=50%2C50&amp;ssl=1 50w" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-43.png?fit=294%2C300&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-43.png?fit=634%2C648&amp;ssl=1" data-orig-size="634,648" data-permalink="https://thecleverprogrammer.com/2020/05/15/amazon-product-reviews-sentiment-analysis-with-machine-learning/untitled-43-2/" data-recalc-dims="1" decoding="async" height="527" src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-43.png?resize=516%2C527&amp;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" width="516"/><noscript><img alt="" class="wp-image-1438" data-attachment-id="1438" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="Untitled-43" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-43.png?fit=634%2C648&amp;ssl=1" data-lazy-fallback="1" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-43.png?fit=294%2C300&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-43.png?fit=634%2C648&amp;ssl=1" data-orig-size="634,648" data-permalink="https://thecleverprogrammer.com/2020/05/15/amazon-product-reviews-sentiment-analysis-with-machine-learning/untitled-43-2/" data-recalc-dims="1" decoding="async" height="527" loading="lazy" sizes="(max-width: 516px) 100vw, 516px" src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-43.png?resize=516%2C527&amp;ssl=1" srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-43.png?w=634&amp;ssl=1 634w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-43.png?resize=294%2C300&amp;ssl=1 294w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-43.png?resize=600%2C613&amp;ssl=1 600w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/Untitled-43.png?resize=50%2C50&amp;ssl=1 50w" width="516"/></noscript></figure>
<p><strong>Lets see all the different names for this product that have 2 ASINs</strong>:</p>
<div class="wp-block-codemirror-blocks-code-block code-block"><pre class="CodeMirror" data-setting='{"mode":"python","mime":"text/x-python","theme":"default","lineNumbers":true,"styleActiveLine":false,"lineWrapping":false,"readOnly":true,"showPanel":false,"language":"Python","modeName":"python"}'>different_names = reviews[reviews["asins"] ==
                          "B00L9EPT8O,B01E6AO69U"]["name"].unique()
for name in different_names:
    print(name)
print(reviews[reviews["asins"] == "B00L9EPT8O,B01E6AO69U"]["name"].value_counts())</pre></div>
<div class="wp-block-codemirror-blocks-code-block code-block"><pre class="CodeMirror" data-setting='{"mode":"htmlmixed","mime":"text/html","theme":"neo","lineNumbers":true,"styleActiveLine":false,"lineWrapping":false,"readOnly":true,"showPanel":false,"language":"HTML","modeName":"html"}'>#Output
Echo (White),,,
Echo (White),,,
Amazon Fire Tv,,,
Amazon Fire Tv,,,
nan
Amazon - Amazon Tap Portable Bluetooth and Wi-Fi Speaker - Black,,,
Amazon - Amazon Tap Portable Bluetooth and Wi-Fi Speaker - Black,,,
Amazon Fire Hd 10 Tablet, Wi-Fi, 16 Gb, Special Offers - Silver Aluminum,,,
Amazon Fire Hd 10 Tablet, Wi-Fi, 16 Gb, Special Offers - Silver Aluminum,,,
Amazon 9W PowerFast Official OEM USB Charger and Power Adapter for Fire Tablets and Kindle eReaders,,,
Amazon 9W PowerFast Official OEM USB Charger and Power Adapter for Fire Tablets and Kindle eReaders,,,
Amazon Kindle Fire 5ft USB to Micro-USB Cable (works with most Micro-USB Tablets),,,
Amazon Kindle Fire 5ft USB to Micro-USB Cable (works with most Micro-USB Tablets),,,
Kindle Dx Leather Cover, Black (fits 9.7 Display, Latest and 2nd Generation Kindle Dxs),,
Amazon Fire Hd 6 Standing Protective Case(4th Generation - 2014 Release), Cayenne Red,,,
Amazon Fire Hd 6 Standing Protective Case(4th Generation - 2014 Release), Cayenne Red,,,
Amazon Fire Hd 6 Standing Protective Case(4th Generation - 2014 Release), Cayenne Red,,,
Amazon 5W USB Official OEM Charger and Power Adapter for Fire Tablets and Kindle eReaders,,,
New Amazon Kindle Fire Hd 9w Powerfast Adapter Charger + Micro Usb Angle Cable,,,
New Amazon Kindle Fire Hd 9w Powerfast Adapter Charger + Micro Usb Angle Cable,,,
Amazon 5W USB Official OEM Charger and Power Adapter for Fire Tablets and Kindle eReaders,,,
Amazon 5W USB Official OEM Charger and Power Adapter for Fire Tablets and Kindle eReaders,,,
Echo (White),,,
Fire Tablet, 7 Display, Wi-Fi, 8 GB - Includes Special Offers, Tangerine"
Echo (Black),,,
Amazon 9W PowerFast Official OEM USB Charger and Power Adapter for Fire Tablets and Kindle eReaders,,,
Echo (Black),,,
Echo (Black),,,
Amazon Fire Tv,,,
Kindle Dx Leather Cover, Black (fits 9.7 Display, Latest and 2nd Generation Kindle Dxs)",,
New Amazon Kindle Fire Hd 9w Powerfast Adapter Charger + Micro Usb Angle Cable,,,

Echo (White),,,\r\nEcho (White),,,                                                                                                                                                                                  2318
Amazon Fire Tv,,,\r\nAmazon Fire Tv,,,                                                                                                                                                                              2029
Amazon - Amazon Tap Portable Bluetooth and Wi-Fi Speaker - Black,,,\r\nAmazon - Amazon Tap Portable Bluetooth and Wi-Fi Speaker - Black,,,                                                                           259
Amazon Fire Hd 10 Tablet, Wi-Fi, 16 Gb, Special Offers - Silver Aluminum,,,\r\nAmazon Fire Hd 10 Tablet, Wi-Fi, 16 Gb, Special Offers - Silver Aluminum,,,                                                           106
Amazon 9W PowerFast Official OEM USB Charger and Power Adapter for Fire Tablets and Kindle eReaders,,,\r\nAmazon 9W PowerFast Official OEM USB Charger and Power Adapter for Fire Tablets and Kindle eReaders,,,      28
Kindle Dx Leather Cover, Black (fits 9.7 Display, Latest and 2nd Generation Kindle Dxs),,                                                                                                                              7
Amazon 5W USB Official OEM Charger and Power Adapter for Fire Tablets and Kindle eReaders,,,\r\nAmazon 5W USB Official OEM Charger and Power Adapter for Fire Tablets and Kindle eReaders,,,                           5
Amazon Fire Hd 6 Standing Protective Case(4th Generation - 2014 Release), Cayenne Red,,,\r\nAmazon Fire Hd 6 Standing Protective Case(4th Generation - 2014 Release), Cayenne Red,,,                                   5
New Amazon Kindle Fire Hd 9w Powerfast Adapter Charger + Micro Usb Angle Cable,,,\r\nNew Amazon Kindle Fire Hd 9w Powerfast Adapter Charger + Micro Usb Angle Cable,,,                                                 5
Amazon Kindle Fire 5ft USB to Micro-USB Cable (works with most Micro-USB Tablets),,,\r\nAmazon Kindle Fire 5ft USB to Micro-USB Cable (works with most Micro-USB Tablets),,,                                           4
Echo (Black),,,\r\nEcho (Black),,,                                                                                                                                                                                     3
Echo (White),,,\r\nFire Tablet, 7 Display, Wi-Fi, 8 GB - Includes Special Offers, Tangerine"                                                                                                                           1
Amazon Fire Hd 6 Standing Protective Case(4th Generation - 2014 Release), Cayenne Red,,,\r\nAmazon 5W USB Official OEM Charger and Power Adapter for Fire Tablets and Kindle eReaders,,,                               1
Echo (Black),,,\r\nAmazon 9W PowerFast Official OEM USB Charger and Power Adapter for Fire Tablets and Kindle eReaders,,,                                                                                              1
New Amazon Kindle Fire Hd 9w Powerfast Adapter Charger + Micro Usb Angle Cable,,,\r\n                                                                                                                                  1
Amazon Fire Tv,,,\r\nKindle Dx Leather Cover, Black (fits 9.7 Display, Latest and 2nd Generation Kindle Dxs)",,                                                                                                        1
Name: name, dtype: int64</pre></div>
<p><strong>The output</strong> <strong>confirmed that each ASIN can have multiple names. Therefore we should only really concern ourselves with which ASINs do well, not the product names.</strong></p>
<div class="wp-block-codemirror-blocks-code-block code-block"><pre class="CodeMirror" data-setting='{"mode":"python","mime":"text/x-python","theme":"default","lineNumbers":true,"styleActiveLine":false,"lineWrapping":false,"readOnly":true,"showPanel":false,"language":"Python","modeName":"python"}'>fig = plt.figure(figsize=(16,10))
ax1 = plt.subplot(211)
ax2 = plt.subplot(212, sharex = ax1)
reviews["asins"].value_counts().plot(kind="bar", ax=ax1, title="ASIN Frequency")
np.log10(reviews["asins"].value_counts()).plot(kind="bar", ax=ax2,
                                               title="ASIN Frequency (Log10 Adjusted)")
plt.show()</pre></div>
<figure class="wp-block-image size-large"><img alt="" class="wp-image-1440 jetpack-lazy-image" data-attachment-id="1440" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="download-1" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-1.png?fit=939%2C714&amp;ssl=1" data-lazy-sizes="(max-width: 939px) 100vw, 939px" data-lazy-src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-1.png?resize=939%2C714&amp;is-pending-load=1#038;ssl=1" data-lazy-srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-1.png?w=939&amp;ssl=1 939w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-1.png?resize=300%2C228&amp;ssl=1 300w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-1.png?resize=768%2C584&amp;ssl=1 768w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-1.png?resize=600%2C456&amp;ssl=1 600w" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-1.png?fit=300%2C228&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-1.png?fit=939%2C714&amp;ssl=1" data-orig-size="939,714" data-permalink="https://thecleverprogrammer.com/2020/05/15/amazon-product-reviews-sentiment-analysis-with-machine-learning/download-1/" data-recalc-dims="1" decoding="async" height="714" src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-1.png?resize=939%2C714&amp;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" width="939"/><noscript><img alt="" class="wp-image-1440" data-attachment-id="1440" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="download-1" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-1.png?fit=939%2C714&amp;ssl=1" data-lazy-fallback="1" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-1.png?fit=300%2C228&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-1.png?fit=939%2C714&amp;ssl=1" data-orig-size="939,714" data-permalink="https://thecleverprogrammer.com/2020/05/15/amazon-product-reviews-sentiment-analysis-with-machine-learning/download-1/" data-recalc-dims="1" decoding="async" height="714" loading="lazy" sizes="(max-width: 939px) 100vw, 939px" src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-1.png?resize=939%2C714&amp;ssl=1" srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-1.png?w=939&amp;ssl=1 939w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-1.png?resize=300%2C228&amp;ssl=1 300w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-1.png?resize=768%2C584&amp;ssl=1 768w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-1.png?resize=600%2C456&amp;ssl=1 600w" width="939"/></noscript></figure>
<h3 class="wp-block-heading">Entire training dataset average rating</h3>
<div class="wp-block-codemirror-blocks-code-block code-block"><pre class="CodeMirror" data-setting='{"mode":"python","mime":"text/x-python","theme":"default","lineNumbers":true,"styleActiveLine":false,"lineWrapping":false,"readOnly":true,"showPanel":false,"language":"Python","modeName":"python"}'>print(reviews["reviews.rating"].mean())

asins_count_ix = reviews["asins"].value_counts().index
plt.subplots(2,1,figsize=(16,12))
plt.subplot(2,1,1)
reviews["asins"].value_counts().plot(kind="bar", title="ASIN Frequency")
plt.subplot(2,1,2)
sns.pointplot(x="asins", y="reviews.rating", order=asins_count_ix, data=reviews)
plt.xticks(rotation=90)
plt.show()</pre></div>
<figure class="wp-block-image size-large"><img alt="" class="wp-image-1442 jetpack-lazy-image" data-attachment-id="1442" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="download-2" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-2.png?fit=944%2C837&amp;ssl=1" data-lazy-sizes="(max-width: 944px) 100vw, 944px" data-lazy-src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-2.png?resize=944%2C837&amp;is-pending-load=1#038;ssl=1" data-lazy-srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-2.png?w=944&amp;ssl=1 944w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-2.png?resize=300%2C266&amp;ssl=1 300w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-2.png?resize=768%2C681&amp;ssl=1 768w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-2.png?resize=600%2C532&amp;ssl=1 600w" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-2.png?fit=300%2C266&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-2.png?fit=944%2C837&amp;ssl=1" data-orig-size="944,837" data-permalink="https://thecleverprogrammer.com/2020/05/15/amazon-product-reviews-sentiment-analysis-with-machine-learning/download-2/" data-recalc-dims="1" decoding="async" height="837" src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-2.png?resize=944%2C837&amp;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" width="944"/><noscript><img alt="" class="wp-image-1442" data-attachment-id="1442" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="download-2" data-large-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-2.png?fit=944%2C837&amp;ssl=1" data-lazy-fallback="1" data-medium-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-2.png?fit=300%2C266&amp;ssl=1" data-orig-file="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-2.png?fit=944%2C837&amp;ssl=1" data-orig-size="944,837" data-permalink="https://thecleverprogrammer.com/2020/05/15/amazon-product-reviews-sentiment-analysis-with-machine-learning/download-2/" data-recalc-dims="1" decoding="async" height="837" loading="lazy" sizes="(max-width: 944px) 100vw, 944px" src="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-2.png?resize=944%2C837&amp;ssl=1" srcset="https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-2.png?w=944&amp;ssl=1 944w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-2.png?resize=300%2C266&amp;ssl=1 300w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-2.png?resize=768%2C681&amp;ssl=1 768w, https://i0.wp.com/thecleverprogrammer.com/wp-content/uploads/2020/05/download-2.png?resize=600%2C532&amp;ssl=1 600w" width="944"/></noscript></figure>
<h2 class="wp-block-heading">Sentiment Analysis</h2>
<p><strong>Using the features in place, we will build a classifier that can determine a review’s sentiment.</strong></p><div class="code-block code-block-2" style="margin: 8px auto; text-align: center; display: block; clear: both;">
<script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6306647371633064"></script>
<!-- Aman -->
<ins class="adsbygoogle" data-ad-client="ca-pub-6306647371633064" data-ad-format="auto" data-ad-slot="6671908539" data-full-width-responsive="true" style="display:block"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
<div class="wp-block-codemirror-blocks-code-block code-block"><pre class="CodeMirror" data-setting='{"mode":"python","mime":"text/x-python","theme":"default","lineNumbers":true,"styleActiveLine":false,"lineWrapping":false,"readOnly":true,"showPanel":false,"language":"Python","modeName":"python"}'>def sentiments(rating):
    if (rating == 5) or (rating == 4):
        return "Positive"
    elif rating == 3:
        return "Neutral"
    elif (rating == 2) or (rating == 1):
        return "Negative"
# Add sentiments to the data
strat_train["Sentiment"] = strat_train["reviews.rating"].apply(sentiments)
strat_test["Sentiment"] = strat_test["reviews.rating"].apply(sentiments)
print(strat_train["Sentiment"][:20])</pre></div>
<p><strong>#Output-</strong></p>
<div class="wp-block-codemirror-blocks-code-block code-block"><pre class="CodeMirror" data-setting='{"mode":"htmlmixed","mime":"text/html","theme":"neo","lineNumbers":true,"styleActiveLine":false,"lineWrapping":false,"readOnly":true,"showPanel":false,"fileName":"HTML","language":"HTML","modeName":"html"}'>4349     Positive
30776    Positive
28775     Neutral
1136     Positive
17803    Positive
7336     Positive
32638    Positive
13995    Positive
6728     Negative
22009    Positive
11047    Positive
22754    Positive
5578     Positive
11673    Positive
19168    Positive
14903    Positive
30843    Positive
5440     Positive
28940    Positive
31258    Positive
Name: Sentiment, dtype: object</pre></div>
<!-- AI CONTENT END 1 -->
</div>